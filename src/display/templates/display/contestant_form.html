{% extends "base.html" %}
{% load static %}
{% load bootstrap4 %}
{% block content %}
    {% if object %}
        <h2>Update Contestant {{ object }} for navigation task {{ object.navigation_task }}</h2>
    {% else %}
        <h2>Create new Contestant for navigation task {{ navigation_task }} </h2>
    {% endif %}
    {{ form.media }}
    Contest time zone is {{ navigation_task.time_zone }}
    <form method="post" class="form">
        {% csrf_token %}
        {% bootstrap_form form %}
        {% buttons %}
            <button type="submit" class="btn btn-primary">Submit</button>
        {% endbuttons %}
    </form>
    <script type="text/javascript">
        $('#id_takeoff_time').datetimepicker({dateFormat: "yy-mm-dd"});
        $('#id_finished_by_time').datetimepicker({dateFormat: "yy-mm-dd"});
        $('#id_tracker_start_time').datetimepicker({dateFormat: "yy-mm-dd"});
        $(document).ready(function () {
            $("#id_team").change(function () {
                var team = $(this).val(); // display the selected text
                console.log("Selected team: " + team)
                // AJAX
                $.ajax({
                    url: "/display/contestteam/autocomplete/pk/",
                    type: 'post',
                    data: {search: team, contest: {{ navigation_task.contest.pk }}, request: 2},
                    dataType: 'json',
                    success: function (response) {

                        // Set value to textboxes
                        document.getElementById('id_tracker_device_id').value = response['tracker_device_id'];


                    }
                });

            });
        });
    </script>
{% endblock %}
